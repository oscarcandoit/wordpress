---
url: https://www.php.net/manual/en/pdo.lastinsertid.php
scraped_at: 2025-10-20T02:57:35.869Z
---

Change language:EnglishGermanSpanishFrenchItalianJapaneseBrazilian PortugueseRussianTurkishUkrainianChinese (Simplified)Other

# PDO::lastInsertId

(PHP 5 >= 5.1.0, PHP 7, PHP 8, PECL pdo >= 0.1.0)

PDO::lastInsertId —
Returns the ID of the last inserted row or sequence value


### Description [¶](https://www.php.net/manual/en/pdo.lastinsertid.php\#refsect1-pdo.lastinsertid-description)

public**PDO::lastInsertId**([?](https://www.php.net/manual/en/language.types.null.php)[string](https://www.php.net/manual/en/language.types.string.php) `$name` = **`[null](https://www.php.net/manual/en/reserved.constants.php#constant.null)`**): [string](https://www.php.net/manual/en/language.types.string.php)\|[false](https://www.php.net/manual/en/language.types.singleton.php)

Returns the ID of the last inserted row, or the last value from a
sequence object, depending on the underlying driver. For example,
[PDO\_PGSQL](https://www.php.net/manual/en/ref.pdo-pgsql.php) allows the name of any
sequence object to be specified for the `name` parameter.


> **Note**:
>
>
> This method may not return a meaningful or consistent result across
> different PDO drivers, because the underlying database may not even
> support the notion of auto-increment fields or sequences.

### Parameters [¶](https://www.php.net/manual/en/pdo.lastinsertid.php\#refsect1-pdo.lastinsertid-parameters)

`name`

Name of the sequence object from which the ID should be returned.


### Return Values [¶](https://www.php.net/manual/en/pdo.lastinsertid.php\#refsect1-pdo.lastinsertid-returnvalues)

If a sequence name was not specified for the `name`
parameter, **PDO::lastInsertId()** returns a
string representing the row ID of the last row that was inserted into
the database.


If a sequence name was specified for the `name`
parameter, **PDO::lastInsertId()** returns a
string representing the last value retrieved from the specified sequence
object.


If the PDO driver does not support this capability,
**PDO::lastInsertId()** triggers an
`IM001` SQLSTATE.


### Errors/Exceptions [¶](https://www.php.net/manual/en/pdo.lastinsertid.php\#refsect1-pdo.lastinsertid-errors)

Emits an error with level **`[E\_WARNING](https://www.php.net/manual/en/errorfunc.constants.php#constant.e-warning)`** if the attribute **`[PDO::ATTR\_ERRMODE](https://www.php.net/manual/en/pdo.constants.php#pdo.constants.attr-errmode)`** is set
to **`[PDO::ERRMODE\_WARNING](https://www.php.net/manual/en/pdo.constants.php#pdo.constants.errmode-warning)`**.

Throws a [PDOException](https://www.php.net/manual/en/class.pdoexception.php) if the attribute **`[PDO::ATTR\_ERRMODE](https://www.php.net/manual/en/pdo.constants.php#pdo.constants.attr-errmode)`**
is set to **`[PDO::ERRMODE\_EXCEPTION](https://www.php.net/manual/en/pdo.constants.php#pdo.constants.errmode-exception)`**.

### Found A Problem?

[Learn How To Improve This Page](https://github.com/php/doc-base/blob/master/README.md "This will take you to our contribution guidelines on GitHub")
•
[Submit a Pull Request](https://github.com/php/doc-en/blob/master/reference/pdo/pdo/lastinsertid.xml)
•
[Report a Bug](https://github.com/php/doc-en/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fpdo.lastinsertid%0A%0A---)

[＋add a note](https://www.php.net/manual/add-note.php?sect=pdo.lastinsertid&repo=en&redirect=https://www.php.net/manual/en/pdo.lastinsertid.php)

### User Contributed Notes 12 notes

[up](https://www.php.net/manual/vote-note.php?id=107622&page=pdo.lastinsertid&vote=up "Vote up!")

[down](https://www.php.net/manual/vote-note.php?id=107622&page=pdo.lastinsertid&vote=down "Vote down!")

259


[**_spark at limao dot com dot br_**](https://www.php.net/manual/en/pdo.lastinsertid.php#107622) [¶](https://www.php.net/manual/en/pdo.lastinsertid.php#107622)

**13 years ago**

`Remember, if you use a transaction you should use lastInsertId BEFORE you commit
otherwise it will return 0`

[up](https://www.php.net/manual/vote-note.php?id=122009&page=pdo.lastinsertid&vote=up "Vote up!")

[down](https://www.php.net/manual/vote-note.php?id=122009&page=pdo.lastinsertid&vote=down "Vote down!")

88


[**_toinenkayt (ta at ta) \[iwonderr\] gmail d_**](https://www.php.net/manual/en/pdo.lastinsertid.php#122009) [¶](https://www.php.net/manual/en/pdo.lastinsertid.php#122009)

**7 years ago**

`To save time for some of you.
When using MySQL or MariaDB while inserting multiple rows in a single query (INSERT INTO table (a,b,c) VALUES (1,2,3), (2,3,4), ...) to a table with auto_increment column, PDO::lastInsertId does NOT return the autogenerated id of the last row. Instead, the FIRST generated id is returned. This may very well be explained by taking a look at MySQL and MariaDB's documentation.
Quotations from their respective documentations,
MySQL:
"With no argument, LAST_INSERT_ID() returns a BIGINT UNSIGNED (64-bit) value representing the first automatically generated value successfully inserted for an AUTO_INCREMENT column as a result of the most recently executed INSERT statement."
MariaDB:
"LAST_INSERT_ID() (no arguments) returns the first automatically generated value successfully inserted for an AUTO_INCREMENT column as a result of the most recently executed INSERT statement."
This is clearly not what lastInsertId's own documentation states. Hopefully this will save someone from debugging the cause of id mismatch.
tl;dr (MySQL | Mariadb) + multi row insert + PDO::lastInsertId = first autogenerated id
Behaviour tested using MariaDB 10.2.6 32-bit, PHP 5.6.31 32-bit and mysqlnd 5.0.11 running on windows 7.`

[up](https://www.php.net/manual/vote-note.php?id=85129&page=pdo.lastinsertid&vote=up "Vote up!")

[down](https://www.php.net/manual/vote-note.php?id=85129&page=pdo.lastinsertid&vote=down "Vote down!")

74


[**_Nour_**](https://www.php.net/manual/en/pdo.lastinsertid.php#85129) [¶](https://www.php.net/manual/en/pdo.lastinsertid.php#85129)

**17 years ago**

`Beware of lastInsertId() when working with transactions in mysql. The following code returns 0 instead of the insert id.
<?php
try {
    $dbh = new PDO('mysql:host=localhost;dbname=test', 'username', 'password');
    $stmt = $dbh->prepare("INSERT INTO test (name, email) VALUES(?,?)");
    try {
        $dbh->beginTransaction();
        $tmt->execute( array('user', 'user@example.com'));
        $dbh->commit();
        print $dbh->lastInsertId();
    } catch(PDOExecption $e) {
        $dbh->rollback();
        print "Error!: " . $e->getMessage() . "</br>";
    }
} catch( PDOExecption $e ) {
    print "Error!: " . $e->getMessage() . "</br>";
}
?>
When no exception is thrown, lastInsertId returns 0. However, if lastInsertId is called before calling commit, the right id is returned.`

[up](https://www.php.net/manual/vote-note.php?id=105580&page=pdo.lastinsertid&vote=up "Vote up!")

[down](https://www.php.net/manual/vote-note.php?id=105580&page=pdo.lastinsertid&vote=down "Vote down!")

27


[**_warezthebeef at gmail dot com_**](https://www.php.net/manual/en/pdo.lastinsertid.php#105580) [¶](https://www.php.net/manual/en/pdo.lastinsertid.php#105580)

**14 years ago**

`If you're accessing MSSQL/SQL Server 2008 R2 (or higher) from Linux via FreeTDS there's a slightly neater way of getting the last insert ID than the solution(s) outlined below.
The specific SQL involved is outlined here:
[http://msdn.microsoft.com/en-us/library/ms177564.aspx](http://msdn.microsoft.com/en-us/library/ms177564.aspx)
So for example, with a table containing the two columns (product_id, product_name) where product_id is a uniqueidentifier or something similar you could do the following.
<?php
// Assume $dbh connection handle is already established
$sql = "INSERT INTO product (product_name) OUTPUT INSERTED.product_id VALUES (?)";
$sth = $dbh->prepare($sql);
$sth->execute(array('widgets'));
$temp = $sth->fetch(PDO::FETCH_ASSOC);
?>
Then $temp will contain an array like:
Array
(
    [product_id] => E1DA1CB0-676A-4CD9-A22C-90C9D4E81914
)
Just be warned that there are some issues relating to how uniqueidentifier columns are handled by PDO_DBLIB/FreeTDS depending on the TDS version you choose that have only been fixed as of PHP 5.3.7.
Information regarding this and the patch can be found here:
[https://bugs.php.net/bug.php?id=54167](https://bugs.php.net/bug.php?id=54167)`

[up](https://www.php.net/manual/vote-note.php?id=68987&page=pdo.lastinsertid&vote=up "Vote up!")

[down](https://www.php.net/manual/vote-note.php?id=68987&page=pdo.lastinsertid&vote=down "Vote down!")

30


[**_dave at dtracorp dot com_**](https://www.php.net/manual/en/pdo.lastinsertid.php#68987) [¶](https://www.php.net/manual/en/pdo.lastinsertid.php#68987)

**19 years ago**

`in case anyone was wondering
something like
$val = 5;
$sql = "REPLACE table (column) VALUES (:val)";
$stmt = $dbh->prepare($sql);
$stmt->bindParam(':val', $val, PDO::PARAM_INT);
$stmt->execute();
$lastId = $dbh->lastInsertId();
will return the last inserted id, whether the record was replaced or simply inserted
the REPLACE syntax, simply inserts, or deletes > inserts
so lastInsertId() still works
refer to [http://mysql.com/doc/refman/5.0/en/replace.html](http://mysql.com/doc/refman/5.0/en/replace.html)
for REPLACE usage`

[up](https://www.php.net/manual/vote-note.php?id=75200&page=pdo.lastinsertid&vote=up "Vote up!")

[down](https://www.php.net/manual/vote-note.php?id=75200&page=pdo.lastinsertid&vote=down "Vote down!")

12


[**_Yonatan Ben-Nes_**](https://www.php.net/manual/en/pdo.lastinsertid.php#75200) [¶](https://www.php.net/manual/en/pdo.lastinsertid.php#75200)

**18 years ago**

`It should be mentioned that this function DOES NOT retrieve the ID (Primary key) of the row but it's OID instead.
So if you use one of the latest PostgreSQL versions this function won't help you unless you add OID to the table specifically when you create it.`

[up](https://www.php.net/manual/vote-note.php?id=102614&page=pdo.lastinsertid&vote=up "Vote up!")

[down](https://www.php.net/manual/vote-note.php?id=102614&page=pdo.lastinsertid&vote=down "Vote down!")

17


[**_ruben02 at hotmail dot com_**](https://www.php.net/manual/en/pdo.lastinsertid.php#102614) [¶](https://www.php.net/manual/en/pdo.lastinsertid.php#102614)

**14 years ago**

`I think I get a nice solution in Postgres to get the ID using the RETURNING that comes with Postgress since version 8.2. In the example below, I add to my insert clause the "returning" along with the primary key of my table, then after the execute, I do a fetch getting an array with the value of the last inserted id.
<?php
    public function insert($employee){
        $sqlQuery = "INSERT INTO employee(user_id,name,address,city) VALUES(:user_id,:name,:address,:city) RETURNING employee_id";
        $statement = $this->prepare($sqlQuery);
        $a ="2002-03-11 12:01AM" ;
        $statement->bindParam(":user_id", $employee->getUserId(), PDO::PARAM_INT);
        $statement->bindParam(":name", $employee->getName(), PDO::PARAM_STR);
        $statement->bindParam(":address", $employee->getAddress(), PDO::PARAM_STR);
        $statement->bindParam(":city", $employee->getCity(), PDO::PARAM_STR);
        $statement->execute();

        $result = $statement->fetch(PDO::FETCH_ASSOC);
        return $result["employee_id"];
    }
?>`

[up](https://www.php.net/manual/vote-note.php?id=126675&page=pdo.lastinsertid&vote=up "Vote up!")

[down](https://www.php.net/manual/vote-note.php?id=126675&page=pdo.lastinsertid&vote=down "Vote down!")

1


[**_phpmanual at NOSPAM dot headbank dot co dot uk_**](https://www.php.net/manual/en/pdo.lastinsertid.php#126675) [¶](https://www.php.net/manual/en/pdo.lastinsertid.php#126675)

**3 years ago**

`MySQL/MariaDB users, be aware that although this function returns a string, leading zeroes are NOT preserved if your column has ZEROFILL property.`

[up](https://www.php.net/manual/vote-note.php?id=120354&page=pdo.lastinsertid&vote=up "Vote up!")

[down](https://www.php.net/manual/vote-note.php?id=120354&page=pdo.lastinsertid&vote=down "Vote down!")

4


[**_enclaved_**](https://www.php.net/manual/en/pdo.lastinsertid.php#120354) [¶](https://www.php.net/manual/en/pdo.lastinsertid.php#120354)

**8 years ago**

`WARNING for PostgreSQL users! In response to the comment by ed at hicklinslade dot com, who wrote:
...
$last_insert_id = $objPDO->lastInsertId("$strTable_id_seq);
This does appear to function as expected. What is a little unclear to me is whether this simply returns the current value of the sequence; if it does, this isn't a particularly reliable indicator as to the id of the record your code just inserted, especially if your site or application is especially high traffic.
...
NEVER ever use lastInsertId() with PostgreSQL sequences, ESPECIALLY when your application's insert/update load is high. PostgreSQL sequences are non-transactional (a natural design feature to avoid exclusive locking which otherwise produces unacceptable performance). This means that any concurrent transaction incrementing the same sequence will render the value returned by lastInsertId() invalid with respect to the last insert by your transaction. Example:
Transaction 1 inserts with nextval('some_seq') yielding 100;
Concurrent transaction 2 inserts with nextval('some_seq') yielding 101;
Transaction 1 calls lastInsertId(), expecting 100, BUT GETS 101.
This PDO method is braindead for PostgreSQL, always use INSERT ... RETURNING instead. Regards.`

[up](https://www.php.net/manual/vote-note.php?id=110037&page=pdo.lastinsertid&vote=up "Vote up!")

[down](https://www.php.net/manual/vote-note.php?id=110037&page=pdo.lastinsertid&vote=down "Vote down!")

4


[**_noel dot mcavoy at gmail dot com_**](https://www.php.net/manual/en/pdo.lastinsertid.php#110037) [¶](https://www.php.net/manual/en/pdo.lastinsertid.php#110037)

**13 years ago**

`This function is now compatible with the newer MS SQL driver. [http://msdn.microsoft.com/en-us/library/ff628155(v=sql.105](http://msdn.microsoft.com/en-us/library/ff628155(v=sql.105))`

[up](https://www.php.net/manual/vote-note.php?id=123467&page=pdo.lastinsertid&vote=up "Vote up!")

[down](https://www.php.net/manual/vote-note.php?id=123467&page=pdo.lastinsertid&vote=down "Vote down!")

0


[**_nafsinvk at gmail dot com_**](https://www.php.net/manual/en/pdo.lastinsertid.php#123467) [¶](https://www.php.net/manual/en/pdo.lastinsertid.php#123467)

**6 years ago**

`$dbh->commit();
print $dbh->lastInsertId();
The above will always return zero (0)
So it is important to call $dbh->lastInsertId();  before commiting transaction
the above should be modified as
print $dbh->lastInsertId();
$dbh->commit();`

[up](https://www.php.net/manual/vote-note.php?id=120618&page=pdo.lastinsertid&vote=up "Vote up!")

[down](https://www.php.net/manual/vote-note.php?id=120618&page=pdo.lastinsertid&vote=down "Vote down!")

0


[**_timer timer five at gmail dot com_**](https://www.php.net/manual/en/pdo.lastinsertid.php#120618) [¶](https://www.php.net/manual/en/pdo.lastinsertid.php#120618)

**8 years ago**

`About the connections created through classes
eg: db::SQL()->query();
then db::SQL()->lastInsertId();
it will create a new connection and will not return the last ID inserted. it is better to include a PDO connection file (or directly the logins) and work with it to get the last ID properly.
$db = new PDO(logins);
$db->query();
$db->lastInsertId();`

[＋add a note](https://www.php.net/manual/add-note.php?sect=pdo.lastinsertid&repo=en&redirect=https://www.php.net/manual/en/pdo.lastinsertid.php)

![To Top](https://www.php.net/images/to-top@2x.png)

`↑` and `↓` to navigate •
`Enter` to select •
`Esc` to close


Press `Enter` without
selection to search using Google